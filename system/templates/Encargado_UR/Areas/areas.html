{% extends "systemsigo/base.html" %}
{% load static %}
{% block content %}

<div class="card">
   <div class="d-flex justify-content-end align-items-center mt-2 mb-3 p-2 mx-1">
            <div class="searchBox position-relative d-flex align-items-center mx-2">
            <i class="bi bi-search me-2 text-secondary"></i>
            <input
                type="text"
                id="input-search"
                class=""
                placeholder="Buscar..."
                oninput="toggleClearButton(this)"
            />
            <button
                id="clear-search"
                type="button"
                class="btn btn-sm btn-link text-secondary px-2 d-none"
                onclick="clearSearch()"
                data-bs-toggle="tooltip"
                data-bs-placement="top"
                title="Borrar búsqueda"
            >
                <i class="bi bi-x-circle-fill"></i>
            </button>
        </div>
        <a href="{% url 'agregar_areas' %}" ><button class="btn btn-primary">Agregar</button></a>
   </div>
   <div class="d-flex align-items-center justify-content-center">
     <div class="table-container">
        <table class="styled-table text-center">
          <thead>
            <tr class="text-center">
                <th colSpan="12" className="table-title" style='background-color: var(--color-uacam-table-header); font-size: 15px;' >
                    Lista de áreas de mi unidad
                </th>
            </tr>
            <tr class="text-center">
              <th>#</th>
              <th>Nombre</th>
              <th>Edificio</th>
              <th>Responsable</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="table-body">
            {% for area in areas %}
              <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ area.nombre }}</td>
                <td>{{ area.edificio.nombre }}</td>
                <td>{{ area.responsable }}</td>
                <td>
                  <div class="d-flex actions justify-content-center">
                    <a href="{% url 'editar_areas' area.id %}" class="btn btn-sm btn-light rounded rounded-circle" 
                    title="Editar información"><i class="bi bi-pencil"></i></a>
                    <button class="btn btn-sm btn-danger mx-1 rounded rounded-circle" onclick="confirmarEliminacion('{{ area.id }}')"
                    title="Eliminar registro"><i class="bi bi-trash-fill"></i></button>
                  </div>
                </td>
              </tr>
            {% empty %}
              <tr><td colspan="5" class="text-center">No hay áreas registradas.</td></tr>
            {% endfor %}
          </tbody>
        </table>
     </div>
   </div>
   <div class="table-header d-flex justify-content-end align-items-center mt-2 mb-3 p-2">
      <ul class="pagination" id="pagination"></ul>
   </div>
</div>

<!-- Función de confirmación SweetAlert2 para eliminar -->
<script>
  function confirmarEliminacion(areaId) {
    Swal.fire({
      title: '¿Estás seguro?',
      text: "Esta acción no se puede deshacer.",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#dc3545',
      cancelButtonColor: '#6c757d',
      confirmButtonText: 'Sí, eliminar',
      cancelButtonText: 'Cancelar'
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = `/areas/eliminar/${areaId}/`;
      }
    });
  }
</script>

{% endblock content %}