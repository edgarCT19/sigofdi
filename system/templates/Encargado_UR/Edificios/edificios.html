{% extends "systemsigo/base.html" %}
{% load static %}
{% block content %}

<div class="card">
    <div class="d-flex justify-content-end align-items-center mt-2 mb-3 p-2 mx-1">
      <div class="searchBox position-relative d-flex align-items-center mx-2">
            <i class="bi bi-search me-2 text-secondary"></i>
            <input
                type="text"
                id="input-search"
                class=""
                placeholder="Buscar..."
                oninput="toggleClearButton(this)"
            />
            <button
                id="clear-search"
                type="button"
                class="btn btn-sm btn-link text-secondary px-2 d-none"
                onclick="clearSearch()"
                data-bs-toggle="tooltip"
                data-bs-placement="top"
                title="Borrar búsqueda"
            >
                <i class="bi bi-x-circle-fill"></i>
            </button>
      </div>
      <a href="{% url 'alta_edificio' %}"><button class="btn btn-primary">Agregar</button></a>
    </div>
    <div class="d-flex align-items-center justify-content-center">
      <div class="table-container">
        <table class="styled-table text-center">
            <thead>
            <tr class="text-center">
                <th colSpan="12" className="table-title" style='background-color: var(--color-uacam-table-header); font-size: 15px;' >
                    Lista de edificios registrados de Unidad Responsable
                </th>
            </tr>
            <tr class="text-center">
                <th>Nombre</th>
                <th>Responsable de alta</th>
                <th>Acciones</th>
            </tr>
            </thead>
            <tbody id="table-body">
            {% for edificio in edificios %}
                <tr>
                <td>{{ edificio.nombre }}</td>
                <td>{{ edificio.responsable_alta }}</td>
                <td>
                    <div class="d-flex actions justify-content-center">
                        <a href="{% url 'editar_edificio' edificio.id %}" 
                        class="btn btn-light btn-sm rounded rounded-circle" title="Editar información" ><i class="bi bi-pencil"></i></a>
                        <button class="btn btn-danger btn-sm rounded rounded-circle mx-1" 
                        onclick="confirmDelete('{{ edificio.id }}')" title="Eliminar registro"><i class="bi bi-trash-fill"></i></button>
                    </div>
                </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
      </div>
    </div>
    <div class="table-header d-flex justify-content-end align-items-center mt-2 mb-3 p-2">
      <ul class="pagination" id="pagination"></ul>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  function confirmDelete(id) {
    Swal.fire({
      title: '¿Eliminar edificio?',
      text: 'Esta acción no se puede deshacer',
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#d33',
      confirmButtonText: 'Sí, eliminar',
      cancelButtonText: 'Cancelar'
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = `/edificios/encargado/eliminar/${id}/`;
      }
    });
  }
</script>
{% endblock content %}